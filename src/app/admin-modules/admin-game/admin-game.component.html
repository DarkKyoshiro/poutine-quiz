<div id="question">
    <mat-card>
        <mat-card-actions>
            <!-- Slides management -->
            <button mat-icon-button aria-label="Previous question" (click)="onPrevious(this.questionID - 1)" *ngIf="this.questions.length !== 0 && this.questionID > 0">
                <mat-icon>fast_rewind</mat-icon>
            </button>
            <button mat-icon-button aria-label="Unlock/Lock question" (click)="onCorrection()" *ngIf="this.questions.length !== 0 && this.questionID > 0 && this.questionID <= this.questions.length">
                <mat-icon *ngIf="this.questions[this.questionID-1].locked">lock</mat-icon>
                <mat-icon *ngIf="!this.questions[this.questionID-1].locked">lock_open</mat-icon>
            </button>
            <button mat-icon-button aria-label="Next question" (click)="onNext(this.questionID + 1)" *ngIf="this.questions.length !== 0 && this.questionID <= this.questions.length-1">
                <mat-icon>fast_forward</mat-icon>
            </button>

            <button mat-icon-button aria-label="Start quiz" (click)="onStartQuiz()" *ngIf="this.questions.length === 0">
                <mat-icon>play_arrow</mat-icon>
            </button>

            <!-- Steps management -->
            <ng-container *ngIf="this.questions.length !== 0 && this.questionID > 0 && this.questionID <= this.questions.length">
                <br>
                <button mat-icon-button aria-label="Show Question" (click)="onShowQuestion()">
                    <mat-icon *ngIf="questions[this.questionID-1].showQuestion">hide_source</mat-icon>
                    <mat-icon *ngIf="!questions[this.questionID-1].showQuestion">question_mark</mat-icon>
                </button>
                <ng-container *ngIf="questions[this.questionID-1].propositionsDetailed">
                    <button mat-icon-button aria-label="Previous step" (click)="onPreviousStep(questions[this.questionID-1].propositionsStep - 1)">
                        <mat-icon>arrow_left</mat-icon>
                    </button>
                    <span class="step">{{questions[this.questionID-1].propositionsStep}}</span>
                    <button mat-icon-button aria-label="Previous step" (click)="onNextStep(questions[this.questionID-1].propositionsStep + 1)">
                        <mat-icon>arrow_right</mat-icon>
                    </button>
                </ng-container>
                <ng-container *ngIf="questions[this.questionID-1].locked">
                    <button mat-icon-button aria-label="Hide answer" (click)="onShowAnswer()">
                        <mat-icon *ngIf="questions[this.questionID-1].showAnswer">hide_source</mat-icon>
                        <mat-icon *ngIf="!questions[this.questionID-1].showAnswer">done_all</mat-icon>
                    </button>
                </ng-container>
            </ng-container>
            
            
            <mat-progress-bar
                color="primary"
                mode="determinate"
                [value]="100 * questionID / (questions.length + 1)">
            </mat-progress-bar>
        </mat-card-actions>

        <ng-container *ngIf="this.questionID > 0 && this.questionID <= this.questions.length">
            <mat-card-header>
                <mat-card-subtitle>Round #{{questions[this.questionID - 1].round}} | {{questions[this.questionID - 1].type}}<span *ngIf="questions[this.questionID - 1].group">-{{questions[this.questionID - 1].group}}</span> | Question nÂ°{{questions[this.questionID - 1].id}}</mat-card-subtitle>
                <mat-card-title [matBadge]="questions[this.questionID - 1].points" matBadgeOverlap="false" matBadgePosition="before">
                    <p>{{questions[this.questionID - 1].question}}</p>
                    <p class="comment">{{questions[this.questionID - 1].questionComment}}</p>
                </mat-card-title>
            </mat-card-header>

            <mat-card-content *ngIf="questions[this.questionID - 1].locked === true" style="white-space: pre-wrap">
                <mat-divider></mat-divider>
                <p>{{questions[this.questionID - 1].answer}}</p>
                <p class="comment">{{questions[this.questionID - 1].answerComment}}</p>
            </mat-card-content>
        </ng-container>
    </mat-card>
</div>

<div id="answers">
    <mat-card class="answer-card" *ngFor="let answer of getAnswers(this.questionID); let i=index" [ngClass]="answer.correct > 0 ? 'correct' : (answer.correct === 0 ? 'incorrect' : '')">
        <mat-card-header>
            <button mat-mini-fab mat-card-avatar [matBadge]="answer.bonusWrongAnswers" [matBadgeHidden]="answer.bonusWrongAnswers<=0" matBadgeOverlap="true">{{this.getTeamScore(answer.teamName)}}</button>
            <mat-card-title [matBadge]="getRanks(answer.teamName)" matBadgeOverlap="false" matBadgePosition="after">
                <p><mat-icon *ngIf="isMenuActive(answer.teamName)">restaurant_menu</mat-icon> {{answer.teamName}}</p>
            </mat-card-title>
        </mat-card-header>

        <mat-card-content>
            <mat-divider></mat-divider>
            <p>{{answer.answer}}</p>
            <mat-divider *ngIf="answer.answer"></mat-divider>
        </mat-card-content>

        <mat-card-actions>
            <ng-container *ngIf="questions[this.questionID - 1].locked === true">
                <button mat-mini-fab color="accent" aria-label="Valid answer" (click)="onValidAnswer(answer.teamName, answer.questionID, 1)">
                    <mat-icon [matBadge]="answer.points" [matBadgeHidden]="answer.correct != 1" matBadgeOverlap="false">check_circle</mat-icon>
                </button>
                <button mat-mini-fab color="warn" aria-label="Incorrect answer" (click)="onValidAnswer(answer.teamName, answer.questionID, 0)">
                    <mat-icon [matBadge]="answer.points" [matBadgeHidden]="answer.correct != 0" matBadgeOverlap="false">cancel</mat-icon>
                </button>
                <button mat-mini-fab color="primary" aria-label="Reset answer" (click)="onValidAnswer(answer.teamName, answer.questionID, -1)">
                    <mat-icon>autorenew</mat-icon>
                </button>
            </ng-container>

            <button mat-mini-fab color="accent" aria-label="Bonus+" (click)="onBonus(answer.teamName, answer.questionID, 1)">
                <mat-icon [matBadge]="answer.bonus" [matBadgeHidden]="answer.bonus<=0" matBadgeOverlap="false">thumb_up</mat-icon>
            </button>
            <button mat-mini-fab color="warn" aria-label="Bonus-" (click)="onBonus(answer.teamName, answer.questionID, -1)">
                <mat-icon [matBadge]="answer.bonus" [matBadgeHidden]="answer.bonus>=0" matBadgeOverlap="false">thumb_down</mat-icon>
            </button>
            <button mat-mini-fab color="primary" aria-label="Reset answer" (click)="onClear(answer.teamName, answer.questionID)">
                <mat-icon>refresh</mat-icon>
            </button>
        </mat-card-actions>
    </mat-card>
</div>