<mat-accordion>
    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                Data backup options
            </mat-panel-title>
        </mat-expansion-panel-header>
        <button mat-raised-button aria-label="Save data" (click)="onSave()">
            <mat-icon>save</mat-icon>
        </button>
        <button mat-raised-button aria-label="Reload data" (click)="onReload()">
            <mat-icon>download</mat-icon>
        </button>
    </mat-expansion-panel>

    <mat-expansion-panel *ngIf="menuDistribution.length !== 0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                Menus attribution
            </mat-panel-title>
        </mat-expansion-panel-header>
        <table mat-table [dataSource]="menuDistribution">
            <ng-container matColumnDef="menuNb">
                <th mat-header-cell *matHeaderCellDef> Menu group </th>
                <td mat-cell *matCellDef="let menu"> {{menu.menuNb}} </td>
            </ng-container>

            <ng-container matColumnDef="round">
                <th mat-header-cell *matHeaderCellDef> Round # </th>
                <td mat-cell *matCellDef="let menu"> {{menu.round}} </td>
            </ng-container>

            <ng-container matColumnDef="teamGroup">
                <th mat-header-cell *matHeaderCellDef> Team group </th>
                <td mat-cell *matCellDef="let menu"> {{menu.teamGroup}} </td>
            </ng-container>

            <ng-container matColumnDef="groupManagement">
                <th mat-header-cell *matHeaderCellDef> Team groups management </th>
                <td mat-cell *matCellDef="let menu">
                    <button mat-icon-button aria-label="Previous group" (click)="onChangeMenuGroup(menu.menuNb, menu.round, menu.teamGroup - 1)">
                        <mat-icon>do_not_disturb_on</mat-icon>
                    </button>
                    <button mat-icon-button aria-label="Next group" (click)="onChangeMenuGroup(menu.menuNb, menu.round, menu.teamGroup + 1)">
                        <mat-icon>add_circle</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="columnsToDisplay2"></tr>
            <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay2"></tr>
        </table>
    </mat-expansion-panel>

    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                Bonus calculation settings
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p><mat-slide-toggle [(ngModel)]="negativePoints" (change)="onChangeNegPoints()">Negative points ?</mat-slide-toggle></p>
        <p><mat-slide-toggle [(ngModel)]="bonusesWrongAnswers" (change)="onChangeBonusesWrongAnswers()">Bonuses for wrong answers ?</mat-slide-toggle></p>
        <p>Team threshold: {{teamThreshold}}
            <mat-slider
                max="100"
                min="0"
                step="5"
                thumbLabel="true"
                [(ngModel)]="teamThreshold"
                (change)="onChangeTreshold()" 
                aria-labelledby="Threshold of team at minimum score (%)">
            </mat-slider>
        </p>
        <p>Team threshold modifier: {{teamThresholdModifier}}
            <mat-slider
                max="3"
                min="0"
                step="0.5"
                thumbLabel="true"
                [(ngModel)]="teamThresholdModifier"
                (change)="onChangeTresholdModifier()" 
                aria-labelledby="Threshold modifier">
            </mat-slider>
        </p>
        <table class="material">
            <tr>
                <th>Position</th>
                <th>1% Errors</th>
                <th>{{percentErrorsTiers[0]}}% Errors</th>
                <th>{{percentErrorsTiers[1]}}% Errors</th>
                <th>Team percentage (%)</th>
            </tr>
            <tr>
                <td>Last</td>
                <td>{{bonusWrong[2]}}</td>
                <td>{{bonusWrong[1]}}</td>
                <td>{{bonusWrong[0]}}</td>
                <td>NA</td>
            </tr>
            <tr>
                <td>Last-1</td>
                <td>0</td>
                <td>{{bonusWrong[2]}}</td>
                <td>{{bonusWrong[1]}}</td>
                <td>{{teamThreshold}}</td>
            </tr>
            <tr>
                <td>Last-2</td>
                <td>0</td>
                <td>0</td>
                <td>{{bonusWrong[2]}}</td>
                <td>{{teamThreshold * teamThresholdModifier}}</td>
            </tr>
        </table>

        <p>Team error percentage threshold: 0 -> {{percentErrorsTiers[0]}} -> {{percentErrorsTiers[1]}}
            <mat-slider
                max="100"
                min="0"
                step="5"
                thumbLabel="true"
                [(ngModel)]="percentErrorsTiers[0]"
                (change)="onChangePercentError()" 
                aria-labelledby="Threshold of team at minimum score (%)">
            </mat-slider> 
            <mat-slider
                max="100"
                min="0"
                step="5"
                thumbLabel="true"
                [(ngModel)]="percentErrorsTiers[1]"
                (change)="onChangePercentError()" 
                aria-labelledby="Threshold of team at minimum score (%)">
            </mat-slider>
        </p>
        <p>Max bonus: 
            <button mat-icon-button aria-label="Previous group" (click)="onChangeBonuses(2, bonusWrong[2]-1)">
                <mat-icon>do_not_disturb_on</mat-icon>
            </button>
            {{bonusWrong[2]}}
            <button mat-icon-button aria-label="Next group" (click)="onChangeBonuses(2, bonusWrong[2]+1)">
                <mat-icon>add_circle</mat-icon>
            </button>
        </p>
        <p>Max bonus-1: 
            <button mat-icon-button aria-label="Previous group" (click)="onChangeBonuses(1, bonusWrong[1]-1)">
                <mat-icon>do_not_disturb_on</mat-icon>
            </button>
            {{bonusWrong[1]}}
            <button mat-icon-button aria-label="Next group" (click)="onChangeBonuses(1, bonusWrong[1]+1)">
                <mat-icon>add_circle</mat-icon>
            </button>
        </p>
        <p>Max bonus-2: 
            <button mat-icon-button aria-label="Previous group" (click)="onChangeBonuses(0, bonusWrong[0]-1)">
                <mat-icon>do_not_disturb_on</mat-icon>
            </button>
            {{bonusWrong[0]}}
            <button mat-icon-button aria-label="Next group" (click)="onChangeBonuses(0, bonusWrong[0]+1)">
                <mat-icon>add_circle</mat-icon>
            </button>
        </p>
    </mat-expansion-panel>
</mat-accordion>