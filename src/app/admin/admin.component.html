<mat-tab-group mat-align-tabs="center"  mat-stretch-tabs>
    <mat-tab label="Teams" *ngIf="this.teams.length !== 0">
        <table mat-table [dataSource]="teams">
            <ng-container matColumnDef="logged">
                <th mat-header-cell *matHeaderCellDef> Status </th>
                <td mat-cell *matCellDef="let team">
                    <mat-icon *ngIf="team.logged">wifi</mat-icon>
                    <mat-icon *ngIf="!team.logged">wifi_off</mat-icon>
                </td>
            </ng-container>

            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef> Nom </th>
                <td mat-cell *matCellDef="let team"> {{team.name}} </td>
            </ng-container>

            <ng-container matColumnDef="score">
                <th mat-header-cell *matHeaderCellDef> Score </th>
                <td mat-cell *matCellDef="let team"> {{team.score}} </td>
            </ng-container>

            <ng-container matColumnDef="group1">
                <th mat-header-cell *matHeaderCellDef> Groupe round 1</th>
                <td mat-cell *matCellDef="let team">
                    <button mat-icon-button aria-label="Previous group" (click)="onChangeGroup(1, team.name, team.group1 - 1)">
                        <mat-icon>do_not_disturb_on</mat-icon>
                    </button>
                    {{team.group1}}
                    <button mat-icon-button aria-label="Next group" (click)="onChangeGroup(1, team.name, team.group1 + 1)">
                        <mat-icon>add_circle</mat-icon>
                    </button>
                </td>
            </ng-container>

            <ng-container matColumnDef="group2">
                <th mat-header-cell *matHeaderCellDef> Groupe round 2</th>
                <td mat-cell *matCellDef="let team">
                    <button mat-icon-button aria-label="Previous group" (click)="onChangeGroup(2, team.name, team.group2 - 1)">
                        <mat-icon>do_not_disturb_on</mat-icon>
                    </button>
                    {{team.group2}}
                    <button mat-icon-button aria-label="Next group" (click)="onChangeGroup(2, team.name, team.group2 + 1)">
                        <mat-icon>add_circle</mat-icon>
                    </button>
                </td>
            </ng-container>

            <ng-container matColumnDef="loggedManagement">
                <th mat-header-cell *matHeaderCellDef> Gestion du status </th>
                <td mat-cell *matCellDef="let team">
                    <button mat-icon-button aria-label="Disconnect team" (click)="onDisconnect(team.name)" *ngIf="team.logged">
                        <mat-icon>signal_wifi_statusbar_null</mat-icon>
                    </button>
                    <button mat-icon-button aria-label="Delete team" (click)="onEject(team.name)">
                        <mat-icon>signal_wifi_off</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
            <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay"></tr>
        </table>
    </mat-tab>


    <mat-tab label="Questions" *ngIf="this.questions.length !== 0">
        <mat-button-toggle-group name="QuestionType" aria-label="Question type selection" style="font-size:small;" [(ngModel)]="questionType">
            <mat-button-toggle value="Nugget"><img src="assets/nuggets.png" alt="Nugget" class="icon"></mat-button-toggle>
            <mat-button-toggle value="SelOuPoivre"><img src="assets/seloupoivre.png" alt="Nugget" class="icon"></mat-button-toggle>
            <mat-button-toggle value="Menu"><img src="assets/menu.png" alt="Nugget" class="icon"></mat-button-toggle>
            <mat-button-toggle value="Addition"><img src="assets/addition.png" alt="Nugget" class="icon"></mat-button-toggle>
        </mat-button-toggle-group>

        <p>
            <span *ngFor="let question of this.questions; let i = index;">
                <button mat-raised-button (click)="onQuestion(question.id)" [matBadge]="question.group" *ngIf="question.type === questionType && question.round === 1">
                    {{question.id}}
                </button>
            </span>
        </p>
        <p>
            <span *ngFor="let question of this.questions; let i = index;">
                <button mat-raised-button (click)="onQuestion(question.id)" [matBadge]="question.group" *ngIf="question.type === questionType && question.round === 2">
                    {{question.id}}
                </button>
            </span>
        </p>


        <button mat-mini-fab color="primary" aria-label="Reset Quiz" (click)="onResetQuiz()" *ngIf="this.questions.length > 0 && !resetCheck">
            <mat-icon>replay</mat-icon>
        </button>
        <button mat-mini-fab color="accent" aria-label="Confirm Reset quiz" (click)="onYesResetQuiz()" *ngIf="this.questions.length > 0 && resetCheck">
            <mat-icon>check</mat-icon>
        </button>
        <button mat-mini-fab color="warn" aria-label="Cancel Reset quiz" (click)="onNoResetQuiz()" *ngIf="this.questions.length > 0 && resetCheck">
            <mat-icon>cancel</mat-icon>
        </button>
    </mat-tab>


    <mat-tab label="Game">
        <div id="question">
            <mat-card>
                <mat-card-actions>
                    <button mat-icon-button aria-label="Previous question" (click)="onPrevious(this.questionID - 1)" *ngIf="this.questions.length !== 0 && this.questionID > 0">
                        <mat-icon>fast_rewind</mat-icon>
                    </button>
                    <button mat-icon-button aria-label="Unlock/Lock question" (click)="onCorrection()" *ngIf="this.questions.length !== 0 && this.questionID > 0 && this.questionID <= this.questions.length">
                        <mat-icon *ngIf="this.questions[this.questionID-1].corrected">lock</mat-icon>
                        <mat-icon *ngIf="!this.questions[this.questionID-1].corrected">lock_open</mat-icon>
                    </button>
                    <button mat-icon-button aria-label="Next question" (click)="onPrevious(this.questionID + 1)" *ngIf="this.questions.length !== 0 && this.questionID <= this.questions.length">
                        <mat-icon>fast_forward</mat-icon>
                    </button>

                    <button mat-icon-button aria-label="Start quiz" (click)="onStartQuiz()" *ngIf="this.questions.length === 0">
                        <mat-icon>play_arrow</mat-icon>
                    </button>
                </mat-card-actions>
                <ng-container *ngIf="this.questionID > 0 && this.questionID <= this.questions.length">
                    <mat-card-header>
                        <mat-card-subtitle>{{questions[this.questionID - 1].type}} nÂ°{{questions[this.questionID - 1].id}}</mat-card-subtitle>
                        <mat-card-title style="white-space: pre-wrap" [matBadge]="questions[this.questionID - 1].points" matBadgeOverlap="false" matBadgePosition="before">{{questions[this.questionID - 1].question}}</mat-card-title>
                    </mat-card-header>
                    <mat-card-content *ngIf="questions[this.questionID - 1].corrected === true" style="white-space: pre-wrap">
                        <mat-divider></mat-divider>
                        <p>{{questions[this.questionID - 1].answer}}</p>
                    </mat-card-content>
                </ng-container>
                <mat-card-footer>
                    <mat-progress-bar
                        color="primary"
                        mode="determinate"
                        [value]="100 * questionID / (questions.length + 1)">
                    </mat-progress-bar>
                </mat-card-footer>
            </mat-card>
        </div>
    
        <div id="answers">
            <mat-card class="answer-card" *ngFor="let answer of getAnswers(this.questionID); let i=index">
                <mat-card-header>
                    <button mat-mini-fab mat-card-avatar>{{this.getTeamScore(answer.teamName)}}</button>
                    <mat-card-title [matBadge]="getRanks(answer.teamName)" matBadgeOverlap="false" matBadgePosition="after">
                        <mat-icon *ngIf="isMenuActive(answer.teamName)">restaurant_menu</mat-icon> {{answer.teamName}} 
                    </mat-card-title>
                    <mat-card-subtitle>
                        <mat-icon *ngIf="answer.correct === 1" color="accent">check</mat-icon>
                        <mat-icon *ngIf="answer.correct === 0" color="warn">close</mat-icon>
                        <span *ngIf="answer.bonus !== 0">{{answer.bonus}}</span>
                        <mat-icon *ngIf="answer.bonus > 0" color="accent">thumb_up</mat-icon>
                        <mat-icon *ngIf="answer.bonus < 0" color="warn">thumb_down</mat-icon>
                    </mat-card-subtitle>
                </mat-card-header>
                <mat-card-content>
                    <mat-divider></mat-divider>
                    <p>{{answer.answer}}</p>
                    <mat-divider></mat-divider>
                </mat-card-content>
                <mat-card-actions>
                    <ng-container *ngIf="questions[this.questionID - 1].corrected === true">
                        <button mat-mini-fab color="accent" aria-label="Valid answer" (click)="onValidAnswer(answer.teamName, answer.questionID, 1)">
                            <mat-icon>check_circle</mat-icon>
                        </button>
                        <button mat-mini-fab color="warn" aria-label="Incorrect answer" (click)="onValidAnswer(answer.teamName, answer.questionID, 0)">
                            <mat-icon>cancel</mat-icon>
                        </button>
                        <button mat-mini-fab color="primary" aria-label="Reset answer" (click)="onValidAnswer(answer.teamName, answer.questionID, -1)">
                            <mat-icon>autorenew</mat-icon>
                        </button>
                    </ng-container>

                    <button mat-mini-fab color="accent" aria-label="Bonus+" (click)="onBonus(answer.teamName, answer.questionID, 1)">
                        <mat-icon>thumb_up</mat-icon>
                    </button>
                    <button mat-mini-fab color="warn" aria-label="Bonus-" (click)="onBonus(answer.teamName, answer.questionID, -1)">
                        <mat-icon>thumb_down</mat-icon>
                    </button>
                    <button mat-mini-fab color="primary" aria-label="Reset answer" (click)="onClear(answer.teamName, answer.questionID)">
                        <mat-icon>refresh</mat-icon>
                    </button>
                </mat-card-actions>
            </mat-card>
        </div>
    </mat-tab>

    <mat-tab label="Settings">
        <button mat-raised-button aria-label="Save data" (click)="onSave()">
            <mat-icon>save</mat-icon>
        </button>
        <button mat-raised-button aria-label="Reload data" (click)="onReload()">
            <mat-icon>download</mat-icon>
        </button>

        <table mat-table [dataSource]="menuDistribution" *ngIf="menuDistribution.length !== 0">
            <ng-container matColumnDef="menuNb">
                <th mat-header-cell *matHeaderCellDef> Menu group </th>
                <td mat-cell *matCellDef="let menu"> {{menu.menuNb}} </td>
            </ng-container>

            <ng-container matColumnDef="round">
                <th mat-header-cell *matHeaderCellDef> Round # </th>
                <td mat-cell *matCellDef="let menu"> {{menu.round}} </td>
            </ng-container>

            <ng-container matColumnDef="teamGroup">
                <th mat-header-cell *matHeaderCellDef> Team group </th>
                <td mat-cell *matCellDef="let menu"> {{menu.teamGroup}} </td>
            </ng-container>

            <ng-container matColumnDef="groupManagement">
                <th mat-header-cell *matHeaderCellDef> Team groups management </th>
                <td mat-cell *matCellDef="let menu">
                    <button mat-icon-button aria-label="Previous group" (click)="onChangeMenuGroup(menu.menuNb, menu.round, menu.teamGroup - 1)">
                        <mat-icon>do_not_disturb_on</mat-icon>
                    </button>
                    <button mat-icon-button aria-label="Next group" (click)="onChangeMenuGroup(menu.menuNb, menu.round, menu.teamGroup + 1)">
                        <mat-icon>add_circle</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="columnsToDisplay2"></tr>
            <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay2"></tr>
        </table>
    </mat-tab>
</mat-tab-group>